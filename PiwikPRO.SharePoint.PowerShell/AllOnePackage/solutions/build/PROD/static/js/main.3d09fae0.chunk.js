(this["webpackJsonppiwik-pro-sharepoint-core"]=this["webpackJsonppiwik-pro-sharepoint-core"]||[]).push([[0],{107:function(e,t,r){"use strict";var n=r(12),a=r(132),_=r(53),o=r(3),i=r.n(o),s=r(8),c=r(2),l=r(49),p=r(7),u=r(25),d=function(){var e=Object(s.a)(i.a.mark((function e(t,r){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(l.c)(t).lists.ensure(r,"",100,!1,{OnQuickLaunch:!1});case 2:if(!(n=e.sent).created){e.next=10;break}return e.next=6,n.list.fields.addText("Value",255);case 6:return e.next=8,n.list.defaultView.fields.add("Value");case 8:return e.next=10,n.list.breakRoleInheritance();case 10:return e.abrupt("return",n.list);case 11:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),f=function(){var e=Object(s.a)(i.a.mark((function e(t,r){var n,a,o,s,c,l;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d(t,r);case 2:return n=e.sent,e.next=5,n.items.select("Id","Title","Value")();case 5:a=e.sent,o={},s=Object(_.a)(a);try{for(s.s();!(c=s.n()).done;)l=c.value,o[l.Title]=l.Value}catch(i){s.e(i)}finally{s.f()}return e.abrupt("return",o);case 10:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),m=function(){var e=Object(s.a)(i.a.mark((function e(t,r,n){var a,_,o,s,c,l;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d(t,r);case 2:return a=e.sent,e.next=5,a.items.select("Id","Title","Value")();case 5:for(_=e.sent,o=[],s=function(){var e=l[c],t=_.find((function(t){return t.Title===e}));t?t.Value!==n[e]&&o.push(a.items.getById(t.Id).update({Value:n[e]})):o.push(a.items.add({Title:e,Value:n[e]}))},c=0,l=Object.keys(n);c<l.length;c++)s();return e.next=11,Promise.all(o);case 11:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),b=function(){var e=Object(s.a)(i.a.mark((function e(t,r){var n,_,o,s,c,p;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r){e.next=6;break}return e.next=3,(_=Object(l.c)(t).allProperties).select.apply(_,Object(a.a)(r))();case 3:n=e.sent,e.next=9;break;case 6:return e.next=8,Object(l.c)(t).allProperties();case 8:n=e.sent;case 9:for(o={},s=0,c=Object.keys(n);s<c.length;s++)p=c[s],o[p.replace(/_x005f_/gi,"_")]=n[p];return e.abrupt("return",o);case 12:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),h=function(){var e=Object(s.a)(i.a.mark((function e(t,r){var n,a,_,o,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=function(){var e=4;return'\n            <Request xmlns="http://schemas.microsoft.com/sharepoint/clientquery/2009" SchemaVersion="15.0.0.0" LibraryVersion="16.0.0.0" ApplicationName="Javascript Library">\n                <Actions>\n                    '.concat(Object.keys(r).map((function(t){return'\n                        <Method Name="SetFieldValue" Id="'.concat(e++,'" ObjectPathId="4">\n                            <Parameters>\n                                <Parameter Type="String">').concat(t,'</Parameter>\n                                <Parameter Type="String">').concat(r[t],"</Parameter>\n                            </Parameters>\n                        </Method>\n                    ")})).join(""),'\n                    <Method Name="Update" Id="').concat(e++,'" ObjectPathId="2" />\n                </Actions>\n                <ObjectPaths>\n                    <StaticProperty Id="0" TypeId="{3747adcd-a3c3-41b9-bfab-4a64dd2f1e0a}" Name="Current" />\n                    <Property Id="2" ParentId="0" Name="Web" />\n                    <Property Id="4" ParentId="2" Name="AllProperties" />\n                </ObjectPaths>\n            </Request>\n        ')}(),a="".concat(t,"/_vti_bin/client.svc/ProcessQuery"),_=new l.a,e.next=5,_.post(a,{headers:{Accept:"*/*","Content-Type":'text/xml;charset="UTF-8"',"X-Requested-With":"XMLHttpRequest"},body:n});case 5:return o=e.sent,e.next=8,o.json();case 8:if(!(s=e.sent)[0].ErrorInfo){e.next=11;break}throw new Error(s[0].ErrorInfo.ErrorMessage);case 11:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),g=function(){var e=Object(s.a)(i.a.mark((function e(){var t,r,n,a,_,o,s,c,d,m,h,g,P,k;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Object(l.c)(window.location.origin+u.a.piwikAdminServerRelativeUrl).currentUser.select("IsSiteAdmin")(),n=b(_spPageContextInfo.siteAbsoluteUrl),a=f(_spPageContextInfo.siteAbsoluteUrl,u.a.siteCollectionSettingsListName),_=Object(l.c)(window.location.origin+u.a.piwikAdminServerRelativeUrl).getList("/sites/PiwikAdmin/Lists/PiwikAdmin").getItemsByCAMLQuery({ViewXml:'<View><Query><Where><Eq><FieldRef Name="pwk_url" /><Value Type="Text">'.concat(_spPageContextInfo.siteAbsoluteUrl,"</Value></Eq></Where></Query></View>")}),e.next=6,r;case 6:if(o=e.sent,s={},c={},!o.IsSiteAdmin){e.next=18;break}return d=b(window.location.origin+u.a.piwikAdminServerRelativeUrl),m=f(window.location.origin+u.a.piwikAdminServerRelativeUrl,u.a.globalSettingsListName),e.next=14,d;case 14:return s=e.sent,e.next=17,m;case 17:c=e.sent;case 18:return e.next=20,n;case 20:return h=e.sent,e.next=23,a;case 23:return g=e.sent,e.next=26,_;case 26:return P=e.sent,k={ClientID:c[p.a.ClientID],ClientSecret:c[p.a.ClientSecret],ContainersUrl:s[p.a.ContainersUrl],EnforceSslComunication:"true"===s[p.a.EnforceSslComunication],IsCurrentUserPiwikAdmin:o.IsSiteAdmin,IsTrackingActive:"true"===h[p.a.IsTrackingActive],JobVersion:s[p.a.JobVersion],PiwikStatus:g[p.a.PiwikStatus]&&"Processed"!==g[p.a.PiwikStatus]?g[p.a.PiwikStatus]:null===(t=P[0])||void 0===t?void 0:t.pwk_status,SendDepartment:"true"===h[p.a.SendDepartment],SendExtendedUserinfo:"true"===h[p.a.SendExtendedUserinfo],SendJobTitle:"true"===h[p.a.SendJobTitle],SendOffice:"true"===h[p.a.SendOffice],SendUserIdEncoded:"true"===h[p.a.SendUserIdEncoded],SendUserName:"true"===h[p.a.SendUserName],SiteId:h[p.a.SiteId],TemplateSendDepartment:"true"===s[p.a.TemplateSendDepartment],TemplateSendExtendedUserinfo:"true"===s[p.a.TemplateSendExtendedUserinfo],TemplateSendJobTitle:"true"===s[p.a.TemplateSendJobTitle],TemplateSendOffice:"true"===s[p.a.TemplateSendOffice],TemplateSendUserIdEncoded:"true"===s[p.a.TemplateSendUserIdEncoded],TemplateSendUserName:"true"===s[p.a.TemplateSendUserName],Url:s[p.a.Url],UseSha3:"true"===s[p.a.UseSha3],UseSiteCollectionSettings:"true"===h[p.a.UseSiteCollectionSettings]},e.abrupt("return",k);case 29:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),P=function(){var e=Object(s.a)(i.a.mark((function e(t){var r,a,_,o,s,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=[],"Adding"!==t.PiwikStatus&&"Deleting"!==t.PiwikStatus){e.next=25;break}if(!(_spPageContextInfo.webAbsoluteUrl.indexOf(".sharepoint.com")>-1)){e.next=6;break}r.push(m(_spPageContextInfo.siteAbsoluteUrl,u.a.siteCollectionSettingsListName,Object(n.a)({},p.a.PiwikStatus,t.PiwikStatus))),e.next=25;break;case 6:return e.t0=r,e.t1=fetch,e.t2="".concat(_spPageContextInfo.siteAbsoluteUrl,"/_vti_bin/CUSTOM/PiwikPROChangeTrackingStatus.svc/ChangeTrackingStatus?status=").concat("Adding"===t.PiwikStatus?"0":"1"),e.next=11,l.d.site.getContextInfo();case 11:if(e.t4=a=e.sent,e.t3=null===e.t4,e.t3){e.next=15;break}e.t3=void 0===a;case 15:if(!e.t3){e.next=19;break}e.t5=void 0,e.next=20;break;case 19:e.t5=null===(_=a.FormDigestValue)||void 0===_?void 0:_.toString();case 20:e.t6=e.t5,e.t7={Accept:"application/json; odata=nometadata","X-RequestDigest":e.t6},e.t8={method:"POST",headers:e.t7},e.t9=(0,e.t1)(e.t2,e.t8),e.t0.push.call(e.t0,e.t9);case 25:return t.IsTrackingActive&&r.push(h(_spPageContextInfo.siteAbsoluteUrl,(o={},Object(n.a)(o,p.a.SendDepartment,t.SendDepartment),Object(n.a)(o,p.a.SendExtendedUserinfo,t.SendExtendedUserinfo),Object(n.a)(o,p.a.SendJobTitle,t.SendJobTitle),Object(n.a)(o,p.a.SendOffice,t.SendOffice),Object(n.a)(o,p.a.SendUserIdEncoded,t.SendUserIdEncoded),Object(n.a)(o,p.a.SendUserName,t.SendUserName),Object(n.a)(o,p.a.UseSiteCollectionSettings,t.UseSiteCollectionSettings),o))),t.IsCurrentUserPiwikAdmin&&(r.push(h(window.location.origin+u.a.piwikAdminServerRelativeUrl,(s={},Object(n.a)(s,p.a.ContainersUrl,t.ContainersUrl),Object(n.a)(s,p.a.EnforceSslComunication,t.EnforceSslComunication),Object(n.a)(s,p.a.TemplateSendDepartment,t.TemplateSendDepartment),Object(n.a)(s,p.a.TemplateSendExtendedUserinfo,t.TemplateSendExtendedUserinfo),Object(n.a)(s,p.a.TemplateSendJobTitle,t.TemplateSendJobTitle),Object(n.a)(s,p.a.TemplateSendOffice,t.TemplateSendOffice),Object(n.a)(s,p.a.TemplateSendUserIdEncoded,t.TemplateSendUserIdEncoded),Object(n.a)(s,p.a.TemplateSendUserName,t.TemplateSendUserName),Object(n.a)(s,p.a.Url,t.Url),Object(n.a)(s,p.a.UseSha3,t.UseSha3),s))),r.push(m(window.location.origin+u.a.piwikAdminServerRelativeUrl,u.a.globalSettingsListName,(c={},Object(n.a)(c,p.a.ClientID,t.ClientID),Object(n.a)(c,p.a.ClientSecret,t.ClientSecret),c)))),e.next=29,Promise.all(r);case 29:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),k=function(){var e=Object(s.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new c.PnPClientStorage,e.next=3,t.session.getOrPut("Piwik:TrackerSettings:".concat(_spPageContextInfo.siteAbsoluteUrl),Object(s.a)(i.a.mark((function e(){var t,r,n,a,_,o,s,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=b(_spPageContextInfo.siteAbsoluteUrl),n=b(window.location.origin+u.a.piwikAdminServerRelativeUrl),e.next=4,r;case 4:return a=e.sent,e.next=7,n;case 7:return _=e.sent,o="true"===a[p.a.UseSiteCollectionSettings],s=o?"true"===a[p.a.SendExtendedUserinfo]:"true"===_[p.a.TemplateSendExtendedUserinfo],c={ContainersUrl:_[p.a.ContainersUrl]||(null===(t=_[p.a.Url])||void 0===t?void 0:t.replace(/\.piwik\.pro/gi,".containers.piwik.pro")),IsTrackingActive:"true"===a[p.a.IsTrackingActive],SendDepartment:s&&(o?"true"===a[p.a.SendDepartment]:"true"===_[p.a.TemplateSendDepartment]),SendJobTitle:s&&(o?"true"===a[p.a.SendJobTitle]:"true"===_[p.a.TemplateSendJobTitle]),SendOffice:s&&(o?"true"===a[p.a.SendOffice]:"true"===_[p.a.TemplateSendOffice]),SendUserIdEncoded:o?"true"===a[p.a.SendUserIdEncoded]:"true"===_[p.a.TemplateSendUserIdEncoded],SendUserName:s&&(o?"true"===a[p.a.SendUserName]:"true"===_[p.a.TemplateSendUserName]),SiteId:a[p.a.SiteId],Url:_[p.a.Url],UseSha3:"true"===_[p.a.UseSha3]},e.abrupt("return",c);case 12:case"end":return e.stop()}}),e)}))),new Date(Date.now()+60*u.a.trackerSettingsCacheExpirationInMinutes*1e3));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();t.a={getSettings:g,setSettings:P,getTrackerSettingsWithCaching:k}},137:function(e,t,r){"use strict";var n;r.d(t,"a",(function(){return n})),function(e){e[e.HISTORY=0]="HISTORY",e[e.CLICK=1]="CLICK",e[e.INIT=2]="INIT",e[e.SP_PAGE_TRANSITION=3]="SP_PAGE_TRANSITION"}(n||(n={}))},25:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(27),a=function e(){Object(n.a)(this,e)};a.piwikAdminServerRelativeUrl="/sites/PiwikAdmin",a.globalSettingsListName="PiwikConfig",a.siteCollectionSettingsListName="PiwikSettings",a.trackerSettingsCacheExpirationInMinutes=60,a.version="1.1.1.0",a.configUrl="".concat(a.piwikAdminServerRelativeUrl,"/_api/web/GetFileByServerRelativeUrl('").concat(a.piwikAdminServerRelativeUrl,"/Style Library/PROD/piwik-config.json')/$value")},308:function(e,t,r){e.exports={piwikProLink:"App_piwikProLink__30Hx0"}},309:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return Tracking}));var C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(12),C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(132),C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(20),C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(3),C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3__),C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(8),C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createForOfIteratorHelper__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(53),C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(27),C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(39),_pnp_common__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(2),crypto_js_sha1__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(185),crypto_js_sha1__WEBPACK_IMPORTED_MODULE_9___default=__webpack_require__.n(crypto_js_sha1__WEBPACK_IMPORTED_MODULE_9__),crypto_js_sha3__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(186),crypto_js_sha3__WEBPACK_IMPORTED_MODULE_10___default=__webpack_require__.n(crypto_js_sha3__WEBPACK_IMPORTED_MODULE_10__),_trackers_TrackersProvider__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(311),_Constants__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(25),fetch_retry__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(187),fetch_retry__WEBPACK_IMPORTED_MODULE_13___default=__webpack_require__.n(fetch_retry__WEBPACK_IMPORTED_MODULE_13__),_services_SettingsService__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(107),_IUrlTrackerProps__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(137),Tracking=function(){function Tracking(e){var t=this;Object(C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_6__.a)(this,Tracking),this.context=e,this.config=void 0,this.trackerSettings=void 0,this.tracker=void 0,this.selectedRows=void 0,this.event=void 0,this.secondSearchAvoid=[],this.secondListItemDirectViewArray=[],this.secondlistItemAttachmentViewArray=[],this.deletedListsBefore=[],this.deletedListsAfter=[],this.fetchOld=window.fetch.bind(window),this.clickedCurrentTarget=void 0,this._nav=void 0,this.getSearchDecoded=function(){t._nav.search_decoded=[];var e,r=Object(C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createForOfIteratorHelper__WEBPACK_IMPORTED_MODULE_5__.a)(t._nav.search.entries());try{for(r.s();!(e=r.n()).done;){var n=e.value;t._nav.search_decoded.push({key:n[0],value:n[1]})}}catch(a){r.e(a)}finally{r.f()}}}return Object(C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_7__.a)(Tracking,[{key:"init",value:function(){var e=Object(C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_4__.a)(C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.mark((function e(){var t,r,n,a,_,o,i=this;return C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_services_SettingsService__WEBPACK_IMPORTED_MODULE_14__.a.getTrackerSettingsWithCaching();case 2:if(this.trackerSettings=e.sent,this.trackerSettings.IsTrackingActive){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,this.loadTagManager();case 7:return t=_spPageContextInfo.siteClientTag.substring(_spPageContextInfo.siteClientTag.lastIndexOf("$")+1,_spPageContextInfo.siteClientTag.length),r="".concat(_Constants__WEBPACK_IMPORTED_MODULE_12__.a.configUrl,"?version=").concat(t,"&tenant=").concat(window.location.hostname),e.next=11,fetch(r);case 11:return n=e.sent,e.next=14,n.json();case 14:if(this.config=e.sent,(a=function(){var e=new _trackers_TrackersProvider__WEBPACK_IMPORTED_MODULE_11__.a(i.config,i.context);i.tracker=e.getTracker()})(),this.trackPageView(),_=function(){i.trackPageView(),i.processDeferredEvent()},!window.asyncDeltaManager){e.next=23;break}window.asyncDeltaManager.add_pageLoaded((function(){setTimeout(Object(C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_4__.a)(C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.mark((function e(){return C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.loadTagManager();case 2:_(),o(),a();case 5:case"end":return e.stop()}}),e)}))),10)})),e.next=25;break;case 23:return e.next=25,this.urlTracker();case 25:document.addEventListener("piwik.pageView",_),(o=function(){i.setXMLHttpRequestInterceptor(window),i.setFetchInterceptor(window),i.setPostMessageInterceptor(window),i.setEventInterceptors(window),i.setSelectedRowsChangedInterceptor(window),window.addEventListener("click",(function(e){return i.event=e}),!0),window.addEventListener("click",(function(){setTimeout((function(){var e=document.querySelectorAll("iframe");Array.from(e).filter((function(e){return e.src.startsWith(window.location.origin)||e.src.startsWith("/")})).forEach((function(e){e.contentWindow.interceptorRegistered||(e.contentWindow.interceptorRegistered=!0,i.setXMLHttpRequestInterceptor(e.contentWindow),i.setFetchInterceptor(e.contentWindow),i.setPostMessageInterceptor(e.contentWindow),i.setEventInterceptors(e.contentWindow),i.setSelectedRowsChangedInterceptor(e.contentWindow),e.contentWindow.addEventListener("click",(function(){setTimeout((function(){window.interceptorRegisteredFromIframe||(window.interceptorRegisteredFromIframe=!0,i.setXMLHttpRequestInterceptor(window),i.setFetchInterceptor(window),i.setPostMessageInterceptor(window),i.setEventInterceptors(window))}),1e3)}),!0))}))}),2e3)}),!0)})(),this.processDeferredEvent();case 29:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"decodeUrls",value:function(e){Object.keys(e).forEach((function(t){e&&e[t]&&null!=e[t]&&void 0!=e[t]&&"string"===(typeof e[t]).toLowerCase()&&(e[t]=e[t].startsWith("http")?decodeURI(e[t]):e[t])}))}},{key:"inIframe",value:function(){try{return window.self!==window.top}catch(e){return!0}}},{key:"trackPageView",value:function(){var e=Object(C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_4__.a)(C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.mark((function e(){var t,r=this;return C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.config.events.filter((function(e){return"pageview"===e.eventType.toLowerCase()}))){e.next=3;break}return e.abrupt("return");case 3:t.forEach((function(e){if((!e.pageUrl||new RegExp(e.pageUrl).test(window.location.href)||new RegExp(e.pageUrl).test(window.location.origin+_spPageContextInfo.serverRequestPath))&&!r.inIframe()){if("pageViewEnrichment"===e.name){if(e.hasOwnProperty("isOnNullPage")&&!e.isOnNullPage&&null===r.context.pageListId&&null===r.context.pageItemId)return;if(e.hasOwnProperty("isOnNullPage")&&e.isOnNullPage&&null!==r.context.pageListId&&null!==r.context.pageItemId)return}r.processMappings(e,window.location.href,null,null,null).then((function(t){r.decodeUrls(t),"pageViewEnrichment"===e.name&&t["!testPropertyForDetectNews"]&&t["!testPropertyForDetectNews"].indexOf("titlePlaceholder")>-1&&t.contentTypeName.indexOf("Site Page")>-1&&(t.contentType="News Page"),Object.keys(t).forEach((function(e){e.startsWith("!")&&delete t[e]})),r.tracker.trackPageView(e.name,window.location.href,t)}))}}));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setXMLHttpRequestInterceptor",value:function(e){var t=this,r=e.XMLHttpRequest.prototype.open,n=e.XMLHttpRequest.prototype.send,a=function(){e.XMLHttpRequest&&(e.XMLHttpRequest.prototype.open=function(a,_,o,i,s){this._method=a,this._url=_,r.call(this,a,_,o,i,s),e.XMLHttpRequest.prototype.send=function(e){var r,a=this,_=(new Date).getTime(),o=this._method,i=this._url,s={};function c(){if(4===a.readyState){var n=(new Date).getTime()-_,c=a.getAllResponseHeaders().trim().split(/[\r\n]+/),l={};if(c.forEach((function(e){var t=e.split(": "),r=t.shift(),n=t.join(": ");l[r]=n})),i.includes("_vti_bin/client.svc/ProcessQuery")){var p=(new DOMParser).parseFromString(e,"text/xml");e=p}t.isStartPage(i)||t.processAjaxRequest(i,o,Object(C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_4__.a)(C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.mark((function t(){return C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e);case 1:case"end":return t.stop()}}),t)}))),Object(C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_4__.a)(C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.mark((function e(){return C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",a.response);case 1:case"end":return e.stop()}}),e)}))),l,n,s)}r&&r()}a.addEventListener?a.addEventListener("readystatechange",c,!1):(r=a.onreadystatechange,a.onreadystatechange=c);var l=t.config.events.filter((function(e){return"ajax"===e.eventType.toLowerCase()&&(null==e.method&&"get"===o.toLowerCase()||e.method.toLowerCase()===o.toLowerCase())&&new RegExp(e.catchFilter,"i").test(function(e){try{return decodeURI(e)}catch(t){return e}}(i))}));Object(C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_4__.a)(C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.mark((function r(){var _;return C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(t.isStartPage(i)){r.next=9;break}_=0;case 2:if(!(_<l.length)){r.next=9;break}if(!l[_].deepCatchPre){r.next=6;break}return r.next=6,t.processDeepCatch(l[_].deepCatchPre,i,Object(C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_4__.a)(C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.mark((function t(){return C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e);case 1:case"end":return t.stop()}}),t)}))),Object(C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_4__.a)(C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.mark((function e(){return C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),{},{},s,l[_]);case 6:_++,r.next=2;break;case 9:n.call(a,e);case 10:case"end":return r.stop()}}),r)})))()}})};a(),setInterval(a,1e3)}},{key:"setFetchInterceptor",value:function(e){var t=this;function r(e){try{return decodeURI(e)}catch(t){return e}}/\{\s+\[native code\]/.test(Function.prototype.toString.call(e.fetch))&&(e.fetch=function(){var e=Object(C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_4__.a)(C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.mark((function e(n,a){var _,o,i,s,c,l,p,u,d;return C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!("string"===typeof n||n instanceof String)){e.next=4;break}e.t0=null,e.next=7;break;case 4:return e.next=6,n.clone();case 6:e.t0=e.sent;case 7:if(_=e.t0,o=null==_?"GET":_.method||"GET",i=null==_?n:_.url,!t.isStartPage(i)){e.next=14;break}return e.next=13,t.fetchOld(n,a);case 13:return e.abrupt("return",e.sent);case 14:s=t.config.events.filter((function(e){return"ajax"===e.eventType.toLowerCase()&&(null==e.method&&"get"===o.toLowerCase()||e.method.toLowerCase()===o.toLowerCase())&&new RegExp(e.catchFilter,"i").test(r(i))})),c={},l=0;case 17:if(!(l<s.length)){e.next=24;break}if(!s[l].deepCatchPre){e.next=21;break}return e.next=21,t.processDeepCatch(s[l].deepCatchPre,i,Object(C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_4__.a)(C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.mark((function e(){return C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=_){e.next=4;break}e.t0=void 0,e.next=7;break;case 4:return e.next=6,_.json();case 6:e.t0=e.sent;case 7:return e.abrupt("return",e.t0);case 8:case"end":return e.stop()}}),e)}))),Object(C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_4__.a)(C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.mark((function e(){return C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),{},{},c,s[l]);case 21:l++,e.next=17;break;case 24:return p=(new Date).getTime(),e.next=27,t.fetchOld(n,a);case 27:return u=e.sent,d=u.clone(),t.processAjaxRequest(i,o,Object(C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_4__.a)(C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.mark((function e(){return C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=_){e.next=4;break}e.t0=void 0,e.next=7;break;case 4:return e.next=6,_.json();case 6:e.t0=e.sent;case 7:return e.abrupt("return",e.t0);case 8:case"end":return e.stop()}}),e)}))),Object(C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_4__.a)(C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.mark((function e(){return C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.clone().json();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),{},(new Date).getTime()-p,c),e.abrupt("return",u);case 31:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}())}},{key:"setPostMessageInterceptor",value:function(e){var t=this;e.addEventListener("message",(function(e){return t.processPostMessage(e.data)}))}},{key:"returnItemsArrayByCatchFilter",value:function returnItemsArrayByCatchFilter(catchFilter){var elements;if(!catchFilter.startsWith("eval:")){try{elements=window.document.querySelectorAll(catchFilter).length>0?window.document.querySelectorAll(catchFilter):window.document.activeElement.contentDocument.querySelectorAll(catchFilter)}catch(_unused2){}return elements}try{return elements=eval(catchFilter.substring(5))||[],Array.isArray(elements)||NodeList.prototype.isPrototypeOf(elements)?elements:[elements]}catch(_unused){}}},{key:"setEventInterceptors",value:function setEventInterceptors(window){var _this6=this,eventConfigs=this.config.events.filter((function(e){return"event"===e.eventType.toLowerCase()})),_iterator2=Object(C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createForOfIteratorHelper__WEBPACK_IMPORTED_MODULE_5__.a)(eventConfigs),_step2;try{var _loop=function _loop(){var eventConfig=_step2.value,register=function register(){setTimeout((function(){var elements=_this6.returnItemsArrayByCatchFilter(eventConfig.catchFilter);elements&&(!eventConfig.pageUrlCondition||eventConfig.pageUrlCondition&&(new RegExp(eventConfig.pageUrlCondition).test(window.location.href)||new RegExp(eventConfig.pageUrlCondition).test(window.location.origin+_spPageContextInfo.serverRequestPath)))&&elements.forEach((function(element){var attributeName="".concat(eventConfig.name).concat(eventConfig.suffix?eventConfig.suffix:"");if(!(element.getAttribute?element.getAttribute(attributeName):element[attributeName])){element.setAttribute?element.setAttribute(attributeName,!0):element[attributeName]=!0;var oldOnClick=element.getAttribute?element.getAttribute("onclick"):void 0,oldOnClickProperty=element.onclick;if("return false;"===oldOnClick&&(oldOnClick=null),eventConfig.blocking&&(oldOnClick&&element.removeAttribute("onclick"),oldOnClickProperty&&(element.onclick=null)),eventConfig.delayClick&&!element.getAttribute("delayClick")){element.removeAttribute("onclick");var delayedOnClick="setTimeout(() => {".concat(oldOnClick,";}, 100)");element.setAttribute("onclick",delayedOnClick),element.setAttribute("delayClick",!0)}element.addEventListener(eventConfig.method,function(){var _ref12=Object(C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_4__.a)(C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.mark((function _callee15(ev){var _window$CalloutManage,oldConfirm,oldHideMenu,oldCalloutManagerCloseAll,response,_window$CalloutManage2,newEvent,_CalloutManager,currentCheckedElementType,eventConfigsToProcess,promises,_newEvent,_currentCheckedElementType;return C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.wrap((function _callee15$(_context15){for(;;)switch(_context15.prev=_context15.next){case 0:if(!eventConfig.targetCatchFilter||ev.target.matches(eventConfig.targetCatchFilter)){_context15.next=2;break}return _context15.abrupt("return");case 2:if(!eventConfig.blocking){_context15.next=30;break}if(ev.piwikTrigger){_context15.next=28;break}if(ev.preventDefault(),ev.stopImmediatePropagation(),eventConfig.useCurrentTarget&&(_this6.clickedCurrentTarget=ev.currentTarget),eventConfig.useWindowTarget&&eventConfig.name.indexOf("topMenuItem")>-1&&(ev.target.className.indexOf("ms-ContextualMenu-itemText")>-1?_this6.clickedCurrentTarget=ev.target.parentElement.parentElement:_this6.clickedCurrentTarget=ev.target),oldOnClick&&element.setAttribute("onclick",oldOnClick),oldOnClickProperty&&(element.onclick=oldOnClickProperty),oldConfirm=window.confirm,oldHideMenu=window.HideMenu,oldCalloutManagerCloseAll=null===(_window$CalloutManage=window.CalloutManager)||void 0===_window$CalloutManage?void 0:_window$CalloutManage.closeAll,response=!0,eventConfig.confirmation&&(window.confirm=function(e){return response=oldConfirm(e),!1},oldHideMenu&&(window.HideMenu=function(){}),(null===(_window$CalloutManage2=window.CalloutManager)||void 0===_window$CalloutManage2?void 0:_window$CalloutManage2.closeAll)&&(CalloutManager.closeAll=function(){return!0}),oldOnClick?eval(oldOnClick):(newEvent=new ev.constructor(ev.type,ev),newEvent.piwikTrigger=!0,ev.target.dispatchEvent(newEvent)),window.confirm=function(){return!0}),!response){_context15.next=26;break}return _context15.next=18,_this6.checkElementType();case 18:return currentCheckedElementType=_context15.sent,eventConfigsToProcess=eventConfigs.filter((function(e){return e.blocking&&e.catchFilter===eventConfig.catchFilter&&e.registerOnEvent===eventConfig.registerOnEvent})),promises=eventConfigsToProcess.map(function(){var e=Object(C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_4__.a)(C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.mark((function e(t){return C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.elementType&&(!t.elementType||t.elementType!==currentCheckedElementType)||!new RegExp(t.pageUrl).test(window.location.href)&&!new RegExp(t.pageUrl).test(window.location.origin+_spPageContextInfo.serverRequestPath)||eventConfig.targetCatchFilter&&!ev.target.matches(eventConfig.targetCatchFilter)){e.next=6;break}return e.next=3,_this6.processEvent(t);case 3:if(!t.immediateProcessDeferred||!t.deferred){e.next=6;break}return e.next=6,_this6.processDeferredEvent();case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),_context15.next=23,Promise.all(promises);case 23:oldHideMenu&&window.HideMenu&&(window.HideMenu=oldHideMenu),oldCalloutManagerCloseAll&&(null===(_CalloutManager=CalloutManager)||void 0===_CalloutManager?void 0:_CalloutManager.closeAll)&&(CalloutManager.closeAll=oldCalloutManagerCloseAll),oldOnClick&&eventConfig.confirmation?eval(oldOnClick):(_newEvent=new ev.constructor(ev.type,ev),_newEvent.piwikTrigger=!0,ev.target.dispatchEvent(_newEvent));case 26:window.confirm=oldConfirm,oldOnClick&&element.removeAttribute("onclick");case 28:_context15.next=39;break;case 30:return _context15.next=32,_this6.checkElementType();case 32:if(_currentCheckedElementType=_context15.sent,eventConfig.elementType&&(!eventConfig.elementType||eventConfig.elementType!==_currentCheckedElementType)){_context15.next=39;break}return _context15.next=36,_this6.processEvent(eventConfig);case 36:if(!eventConfig.immediateProcessDeferred||!eventConfig.deferred){_context15.next=39;break}return _context15.next=39,_this6.processDeferredEvent();case 39:case"end":return _context15.stop()}}),_callee15)})));return function(e){return _ref12.apply(this,arguments)}}(),!0)}}))}),eventConfig.delay||0)};if(eventConfig.registerOnEvent){if(eventConfig.eventNodes){var elements=window.document.querySelectorAll(eventConfig.eventNodes);elements.forEach((function(e){e.addEventListener(eventConfig.registerOnEvent,(function(){return register()}),!0)}))}else window.document.addEventListener(eventConfig.registerOnEvent,(function(){return register()}),!0),eventConfig.listDeletedProcessing&&(_this6.deletedListsBefore=[],document.querySelectorAll("#applist>div>div>div>div>a").forEach((function(e){return _this6.deletedListsBefore.push(e)})));eventConfig.registerOnInit&&register()}else register()};for(_iterator2.s();!(_step2=_iterator2.n()).done;)_loop()}catch(err){_iterator2.e(err)}finally{_iterator2.f()}}},{key:"setSelectedRowsChangedInterceptor",value:function(e){var t=this;e.document.addEventListener("piwik.selectedRowsChanged",(function(e){return t.selectedRows=e.detail}))}},{key:"processEvent",value:function(){var e=Object(C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_4__.a)(C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.mark((function e(t){var r,n;return C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.deferred){e.next=11;break}if(t.pageUrl&&!new RegExp(t.pageUrl).test(window.location.href)&&!new RegExp(t.pageUrl).test(window.location.origin+_spPageContextInfo.serverRequestPath)){e.next=9;break}return(r=JSON.parse(JSON.stringify(t))).deepCatch=null,r.mappings=t.deferredMappings,e.next=7,this.processMappings(r,window.location.href,null,null,null);case 7:n=e.sent,window.sessionStorage["piwik-deferred"]=JSON.stringify({name:r.name,eventType:r.eventType,method:r.method,catchFilter:r.catchFilter,pageUrl:r.pageUrl,suffix:r.suffix,deferredMappings:n,deferredUrl:window.location.href});case 9:e.next=14;break;case 11:if(t.pageUrl&&!new RegExp(t.pageUrl).test(window.location.href)&&!new RegExp(t.pageUrl).test(window.location.origin+_spPageContextInfo.serverRequestPath)){e.next=14;break}return e.next=14,this.processEventInternal(t,window.location.href);case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"processEventInternal",value:function(){var e=Object(C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_4__.a)(C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.mark((function e(t,r){var n,a,_,o,i,s,c,l=this,p=arguments;return C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=p.length>2&&void 0!==p[2]?p[2]:null,e.prev=1,e.next=4,this.processMappings(t,r,null,null,null,n);case 4:if(a=e.sent,!t.filterFiletype||null!=t.filterFiletype&&null!=t.filterFiletype.filetype&&null!=t.filterFiletype.fieldname){e.next=9;break}return e.abrupt("return");case 9:if(!t.filterFiletype||!t.filterFiletype.fieldname){e.next=13;break}if(_=this.getFileType(a[t.filterFiletype.fieldname]),t.filterFiletype.filetype==_){e.next=13;break}return e.abrupt("return");case 13:if(!t.pageUrl||new RegExp(t.pageUrl).test(r)||new RegExp(t.pageUrl).test(window.location.origin+_spPageContextInfo.serverRequestPath)){e.next=17;break}return e.abrupt("return");case 17:if(t.name.indexOf("listCreated")>-1&&null!==a["!DocumentTemplateUrl"]&&(t.name="documentLibraryCreated"),!(t.name.indexOf("reloadTrackerFor")>-1)){e.next=20;break}return e.abrupt("return");case 20:if(!(t.name.indexOf("listItemAttachmentView")>-1)){e.next=26;break}if(!((o=((new Date).getTime()/1e3).toString()).indexOf(".")>-1)){e.next=26;break}if(o=o.split(".")[0],!(this.secondlistItemAttachmentViewArray.indexOf(o)>-1)){e.next=26;break}return e.abrupt("return");case 26:if((t.name.indexOf("folderDownloaded")>-1||t.name.indexOf("fileDownloaded")>-1||t.name.indexOf("folderCreatedOrUploaded")>-1||t.name.indexOf("filePinnedToTop")>-1||t.name.indexOf("fileUnpinned")>-1||t.name.indexOf("folderPinnedToTop")>-1||t.name.indexOf("folderDeleted")>-1||t.name.indexOf("fileUploaded")>-1||t.name.indexOf("fileDeleted")>-1||t.name.indexOf("fileShared")>-1||t.name.indexOf("folderShared")>-1||t.name.indexOf("fileOpenedOrEdited")>-1||t.name.indexOf("folderUnpinned")>-1)&&a.parentFolderUrl==a.documentLibraryUrl&&(a.parentFolderTitle=a["!listTitle"],a.parentFolderName=a.documentLibraryName),!(t.name.indexOf("fileDownloaded")>-1||t.name.indexOf("fileOpenedOrEdited")>-1)){e.next=30;break}if(a.fileExt){e.next=30;break}return e.abrupt("return");case 30:if(Object.keys(a).forEach((function(e){e.startsWith("!")&&delete a[e]})),this.decodeUrls(a),t.name.indexOf("listItemAttachmentView")>-1&&(i=((new Date).getTime()/1e3).toString()).indexOf(".")>-1&&(i=i.split(".")[0],this.secondlistItemAttachmentViewArray.push(i)),t.name.indexOf("pageDeleted")>-1)try{a.pageName.indexOf(".aspx")>-1&&(a.pageName=a.pageName.replace(".aspx",""))}catch(u){}if(!(t.name.indexOf("folderShared")>-1)){e.next=38;break}if(a.folderUrl!==a.documentLibraryUrl){e.next=38;break}return e.abrupt("return");case 38:if(!t.listDeletedProcessing){e.next=61;break}e.prev=39,this.deletedListsAfter=[],document.querySelectorAll("#applist>div>div>div>div>a").forEach((function(e){return l.deletedListsAfter.push(e)})),c=0;case 43:if(!(c<this.deletedListsBefore.length)){e.next=50;break}if(-1!=this.deletedListsAfter.indexOf(this.deletedListsBefore[c])){e.next=47;break}return s=this.deletedListsBefore[c],e.abrupt("break",50);case 47:c++,e.next=43;break;case 50:a.listID=s.id.replace("viewlist",""),a.listTitle=s.title,a.listURL=s.href.substring(0,s.href.lastIndexOf("/")+1),this.deletedListsBefore=[],document.querySelectorAll("#applist>div>div>div>div>a").forEach((function(e){return l.deletedListsBefore.push(e)})),this.deletedListsAfter=[],e.next=61;break;case 58:e.prev=58,e.t0=e.catch(39),console.log("Problem with list deleted event");case 61:return e.next=63,this.tracker.trackEvent(t.name,a);case 63:e.next=69;break;case 65:throw e.prev=65,e.t1=e.catch(1),console.error(e.t1),new Error;case 69:case"end":return e.stop()}}),e,this,[[1,65],[39,58]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"processDeferredEvent",value:function(){var e=Object(C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_4__.a)(C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.mark((function e(){var t,r=this;return C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=window.sessionStorage["piwik-deferred"]){e.next=3;break}return e.abrupt("return");case 3:setTimeout(Object(C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_4__.a)(C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.mark((function e(){var n,a;return C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(window.sessionStorage.removeItem("piwik-deferred"),n=JSON.parse(t),a=r.config.events.find((function(e){return e.name===n.name&&e.eventType===n.eventType&&e.method===n.method&&e.catchFilter===n.catchFilter&&e.pageUrl===n.pageUrl&&e.suffix===n.suffix}))){e.next=5;break}return e.abrupt("return");case 5:if(a.nextPageUrl&&!new RegExp(a.nextPageUrl).test(window.location.href)&&!new RegExp(a.nextPageUrl).test(window.location.origin+_spPageContextInfo.serverRequestPath)){e.next=8;break}return e.next=8,r.processEventInternal(a,n.deferredUrl?n.deferredUrl:window.location.href,n.deferredMappings);case 8:case"end":return e.stop()}}),e)}))),1e3);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"getFileType",value:function(e){if(e){var t,r=e.split(".").pop();return e!==r?"aspx"===r?"page":"file":(null===(t=this.selectedRows)||void 0===t?void 0:t.length)>0&&"OneNote.Notebook"===this.selectedRows[0].ProgId?"file":"folder"}}},{key:"processAjaxRequest",value:function(){var e=Object(C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_4__.a)(C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.mark((function e(t,r,n,a,_,o){var i,s,c=this,l=arguments;return C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s=function(e){try{return decodeURI(e)}catch(t){return e}},i=l.length>6&&void 0!==l[6]?l[6]:{},this.config.events.filter((function(e){return"ajax"===e.eventType.toLowerCase()&&(null==e.method&&"get"===r.toLowerCase()||e.method.toLowerCase()===r.toLowerCase())&&new RegExp(e.catchFilter,"i").test(s(t))})).forEach((function(e){(!e.pageUrlCondition||e.pageUrlCondition&&(new RegExp(e.pageUrlCondition).test(window.location.href)||new RegExp(e.pageUrlCondition).test(window.location.origin+_spPageContextInfo.serverRequestPath)))&&c.processMappings(e,t,n,a,_,void 0,i).then((function(t){if(!e.filterFiletype||null!=e.filterFiletype&&null!=e.filterFiletype.filetype&&null!=e.filterFiletype.fieldname){if(e.filterFiletype&&e.filterFiletype.fieldname){var r=c.getFileType(t[e.filterFiletype.fieldname]);if(e.filterFiletype.filetype!==r)return}if(!e.pageUrl||new RegExp(e.pageUrl).test(window.location.href)||new RegExp(e.pageUrl).test(window.location.origin+_spPageContextInfo.serverRequestPath)){var n,a;if(e.name.indexOf("search")>-1&&e.suffix.indexOf("_classicSP2013")>-1){if(void 0===t.queryString||t.queryString.indexOf("path:&quot;")>-1)return;var _=((new Date).getTime()/1e3).toString();if(_.indexOf(".")>-1&&(_=_.split(".")[0],c.secondSearchAvoid.indexOf(_)>-1))return}if(e.name.indexOf("listItemDirectView")>-1){var i=((new Date).getTime()/1e3).toString();if(i.indexOf(".")>-1&&(i=i.split(".")[0],c.secondListItemDirectViewArray.indexOf(i)>-1))return}if((e.name.indexOf("folderDownloaded")>-1||e.name.indexOf("fileDownloaded")>-1||e.name.indexOf("folderCreatedOrUploaded")>-1||e.name.indexOf("filePinnedToTop")>-1||e.name.indexOf("fileUnpinned")>-1||e.name.indexOf("folderPinnedToTop")>-1||e.name.indexOf("folderDeleted")>-1||e.name.indexOf("fileUploaded")>-1||e.name.indexOf("fileDeleted")>-1||e.name.indexOf("fileShared")>-1||e.name.indexOf("folderShared")>-1||e.name.indexOf("fileOpenedOrEdited")>-1||e.name.indexOf("folderUnpinned")>-1)&&t.parentFolderUrl==t.documentLibraryUrl&&(t.parentFolderTitle=t["!listTitle"],t.parentFolderName=t.documentLibraryName),!(e.name.indexOf("fileDownloaded")>-1||e.name.indexOf("fileOpenedOrEdited")>-1)||t.fileExt){if(e.name.indexOf("publishAction")>-1||e.name.indexOf("pageCreated")>-1||e.name.indexOf("newsPost")>-1||e.name.indexOf("pageEdited")>-1||e.name.indexOf("newsEdited")>-1){var s=0;switch(s=t["!pageVersion"].indexOf(".")>-1?parseInt(t["!pageVersion"].split(".")[0]):parseInt(t["!pageVersion"]),t.typeOfContent){case"0x0101080099FF4FA0A41D6C4FBF4A361E67AD94FF":t.typeOfContent="Wiki Page",e.name="pageCreated";break;case"0x010100066D651BED1B8F4AA6949087C4C86201":t.typeOfContent="Web Part Page",e.name="pageCreated";break;case"0x0101009D1CB255DA76424F860D91F20E6C4118000B9CCA7695D746439680EBD51D3E8011":if(t["!testPageProperty1"]){t.typeOfContent="News Page",e.name=s>1?"newsEdited":"newsPost";break}default:t["!testPageProperty1"]&&t.typeOfContent.indexOf("0x0101009D1CB255DA76424F860D91F20E6C411800")>-1?(t.typeOfContent="News Page",e.name=s>1?"newsEdited":"newsPost"):(t.typeOfContent="Site Page",e.name=s>1?"pageEdited":"pageCreated")}}if("commentItem"!==e.name&&"unlikeItem"!==e.name&&"likeItem"!==e.name&&"commentReply"!==e.name&&"likeComment"!==e.name&&"unlikeComment"!==e.name||(t["!testCommentPageProperty1"]&&t["!testCommentPageProperty1"].indexOf("titlePlaceholder")>-1&&t["!itemContentTypeId"].indexOf("0x0101009D1CB255DA76424F860D91F20E6C411800")>-1?t.contentTypeName="News Page":t["!testCommentPageProperty1"]&&-1==t["!testCommentPageProperty1"].indexOf("titlePlaceholder")&&t["!itemContentTypeId"].indexOf("0x0101009D1CB255DA76424F860D91F20E6C411800")>-1&&(t.contentTypeName="Site Page")),!e.catchFilterPropertyName||e.catchFilterPropertyName===t["!actionName"]){if(Object.keys(t).forEach((function(e){e.startsWith("!")&&delete t[e]})),(null===(n=c.selectedRows)||void 0===n?void 0:n.length)>0&&"OneNote.Notebook"===c.selectedRows[0].ProgId&&(null===e||void 0===e||null===(a=e.mappings)||void 0===a?void 0:a.objectType)&&(t.objectType="OneNote.Notebook"),c.decodeUrls(t),e.name.indexOf("search")>-1){var l=((new Date).getTime()/1e3).toString();l.indexOf(".")>-1&&(l=l.split(".")[0],c.secondSearchAvoid.push(l))}if(e.name.indexOf("listItemDirectView")>-1){var p=((new Date).getTime()/1e3).toString();p.indexOf(".")>-1&&(p=p.split(".")[0],c.secondListItemDirectViewArray.push(p))}c.tracker.trackEvent(e.name,t,o)}}}}}))}));case 4:case"end":return e.stop()}}),e,this)})));return function(t,r,n,a,_,o){return e.apply(this,arguments)}}()},{key:"processPostMessage",value:function(){var e=Object(C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_4__.a)(C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.mark((function e(t){var r,n;return C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.config.events.find((function(e){return"postmessage"===e.eventType.toLowerCase()&&new RegExp(e.catchFilter,"i").test(t)}))){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,this.processMappings(r,window.location.href,null,Object(C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_4__.a)(C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.mark((function e(){return C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",JSON.parse(t));case 1:case"end":return e.stop()}}),e)}))),[]);case 5:if(n=e.sent,!(r.name.indexOf("search")>-1)){e.next=9;break}if(n.queryString){e.next=9;break}return e.abrupt("return");case 9:this.tracker.trackEvent(r.name,n);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"processMappings",value:function(){var e=Object(C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_4__.a)(C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.mark((function e(t,r,n,a,_){var o,i,s,c=arguments;return C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=c.length>5&&void 0!==c[5]?c[5]:null,i=c.length>6&&void 0!==c[6]?c[6]:{},!(t.deepCatch&&0!==Object.keys(t.deepCatch).length||t.deepCatchPre&&0!==Object.keys(t.deepCatchPre).length)){e.next=5;break}return e.next=5,this.processDeepCatch(t.deepCatch,r,n,a,_,o,i,t);case 5:return e.next=7,this.processDeepCatch(this.config.sharedEvent.deepCatch,r,n,a,_,o,i,t);case 7:return s=Object(C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_2__.a)(Object(C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_2__.a)({},this.config.sharedEvent.sharedMappings),t.mappings),Object.keys(s).forEach((function(e){if(e.startsWith("#")){var t=e.substring(1);delete s[t],delete s[e]}})),e.next=12,this.processMappingsInternal(s,r,n,a,_,o,i,t);case 12:return e.abrupt("return",e.sent);case 13:case"end":return e.stop()}}),e,this)})));return function(t,r,n,a,_){return e.apply(this,arguments)}}()},{key:"processDeepCatch",value:function(){var e=Object(C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_4__.a)(C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.mark((function e(t,r,n,a,_){var o,i,s,c,l,p,u,d=this,f=arguments;return C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=f.length>5&&void 0!==f[5]?f[5]:null,i=f.length>6?f[6]:void 0,s=f.length>7?f[7]:void 0,c=Object.keys(t),l=C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.mark((function e(){var c,l,f,m;return C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=u[p],(l={})[c]=t[c],e.next=5,d.processMappingsInternal(l,r,n,a,_,o,i,s);case 5:if((f=e.sent)[c]){e.next=8;break}return e.abrupt("return","continue");case 8:if(m=function(){var e=Object(C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_4__.a)(C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.mark((function e(){var t;return C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(s.xmlInsteadOfJson&&s.xmlInsteadOfJson.indexOf("true")>-1&&c.indexOf("item")>-1)){e.next=6;break}return e.next=3,fetch_retry__WEBPACK_IMPORTED_MODULE_13___default()(d.fetchOld)(f[c],{cache:"no-cache",headers:{Accept:"application/xml","Accept-Language":d.config.language||"en,en-US;q=0.9,de;q=0.8,de-DE;q=0.7,pl;q=0.6","Content-Type":"application/xml;charset=utf-8"},retryOn:[404],retries:10,retryDelay:200});case 3:t=e.sent,e.next=9;break;case 6:return e.next=8,fetch_retry__WEBPACK_IMPORTED_MODULE_13___default()(d.fetchOld)(f[c],{cache:"no-cache",headers:{Accept:"application/json","Accept-Language":d.config.language||"en,en-US;q=0.9,de;q=0.8,de-DE;q=0.7,pl;q=0.6","Content-Type":"application/json;odata=verbose;charset=utf-8"},retryOn:[404],retries:10,retryDelay:200});case 8:t=e.sent;case 9:if(!(s.xmlInsteadOfJson&&s.xmlInsteadOfJson.indexOf("true")>-1&&c.indexOf("item")>-1)){e.next=15;break}return e.next=12,t.clone().text();case 12:return e.abrupt("return",e.sent);case 15:return e.next=17,t.clone().json();case 17:return e.abrupt("return",e.sent);case 18:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),!(c.indexOf(":cached")>-1)){e.next=15;break}return e.next=12,(new _pnp_common__WEBPACK_IMPORTED_MODULE_8__.PnPClientStorage).session.getOrPut("Piwik:DeepCatch:".concat(f[c]),m,new Date(Date.now()+18e5));case 12:i[c.replace(":cached","")]=e.sent,e.next=18;break;case 15:return e.next=17,m();case 17:i[c]=e.sent;case 18:case"end":return e.stop()}}),e)})),p=0,u=c;case 6:if(!(p<u.length)){e.next=14;break}return e.delegateYield(l(),"t0",8);case 8:if("continue"!==e.t0){e.next=11;break}return e.abrupt("continue",11);case 11:p++,e.next=6;break;case 14:case"end":return e.stop()}}),e)})));return function(t,r,n,a,_){return e.apply(this,arguments)}}()},{key:"processMappingsInternal",value:function(){var _processMappingsInternal=Object(C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_4__.a)(C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.mark((function _callee28(mappings,url,bodyGetter,responseGetter,responseHeaders){var _this12=this,deferredMappings,deep,eventConfig,body,response,input,removeStartAspx,processExpression,isMappingIgnored,processMappings,_args29=arguments;return C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.wrap((function _callee28$(_context29){for(;;)switch(_context29.prev=_context29.next){case 0:return deferredMappings=_args29.length>5&&void 0!==_args29[5]?_args29[5]:null,deep=_args29.length>6?_args29[6]:void 0,eventConfig=_args29.length>7?_args29[7]:void 0,input=function(e){var t=document.querySelector(e);return t?t.value:null},removeStartAspx=function(e){return e.replace(/\/_layouts\/1.\/start.aspx\#/,"")},processExpression=function(){var _ref17=Object(C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_4__.a)(C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.mark((function _callee26(expression,key){var tryDecodeURI,splittedExpression,sourceType,valueExpression,regExp,urlObj,urlParams,_urlObj,_urlParams,urlParts,_url,_urlObj2,_urlParams2,_urlObj3,_urlParams3;return C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.wrap((function _callee26$(_context27){for(;;)switch(_context27.prev=_context27.next){case 0:tryDecodeURI=function(e){try{return decodeURI(e)}catch(t){return e}},splittedExpression=expression.split(":"),sourceType=splittedExpression[0],valueExpression=splittedExpression.slice(1).join(":"),_context27.t0=sourceType.toLowerCase(),_context27.next="url"===_context27.t0?7:"global"===_context27.t0?13:"context"===_context27.t0?14:"querystring"===_context27.t0?15:"querystringwithoutquotamarks"===_context27.t0?19:"body"===_context27.t0?22:"response"===_context27.t0?32:"responseheader"===_context27.t0?39:"ancestor"===_context27.t0?40:"eval"===_context27.t0?42:"deep"===_context27.t0?49:"selectedrows"===_context27.t0?50:"clickedtarget"===_context27.t0?51:"complex"===_context27.t0?52:"deferred"===_context27.t0?55:"event"===_context27.t0?56:"folderpath"===_context27.t0?57:59;break;case 7:if(!valueExpression){_context27.next=12;break}return regExp=new RegExp(valueExpression,"i"),_context27.abrupt("return",regExp.exec(removeStartAspx(tryDecodeURI(url)))[1]);case 12:return _context27.abrupt("return",removeStartAspx(tryDecodeURI(url)));case 13:return _context27.abrupt("return",_this12.getPropertyValueByPath(window,valueExpression,key,sourceType,eventConfig));case 14:return _context27.abrupt("return",_this12.getPropertyValueByPath(_this12.context,valueExpression,key,sourceType,eventConfig));case 15:return url=url.replace("#","%23"),urlObj=new URL(url),urlParams=urlObj.searchParams,_context27.abrupt("return",urlParams.get(valueExpression));case 19:return _urlObj=new URL(url),_urlParams=_urlObj.searchParams,_context27.abrupt("return",_urlParams.get(valueExpression).replace("'","").replace("'",""));case 22:if(_context27.prev=22,_context27.t1=body,_context27.t1){_context27.next=28;break}return _context27.next=27,bodyGetter();case 27:_context27.t1=_context27.sent;case 28:body=_context27.t1;case 29:return _context27.prev=29,_context27.abrupt("return",_this12.getPropertyValueByPath(body,valueExpression,key,sourceType,eventConfig));case 32:if(_context27.t2=response,_context27.t2){_context27.next=37;break}return _context27.next=36,responseGetter();case 36:_context27.t2=_context27.sent;case 37:return response=_context27.t2,_context27.abrupt("return",_this12.getPropertyValueByPath(response,valueExpression,key,sourceType,eventConfig));case 39:return _context27.abrupt("return",_this12.getPropertyValueByPath(responseHeaders,valueExpression,key,sourceType,eventConfig));case 40:return urlParts=removeStartAspx(tryDecodeURI(url)).replace(/\/$/gi,"").split("/"),_context27.abrupt("return",urlParts.slice(0,urlParts.length-+valueExpression).join("/"));case 42:return _context27.prev=42,_context27.abrupt("return",eval(valueExpression));case 46:return _context27.prev=46,_context27.t3=_context27.catch(42),_context27.abrupt("return",null);case 49:return _context27.abrupt("return",_this12.getPropertyValueByPath(deep,valueExpression,key,sourceType,eventConfig));case 50:return _context27.abrupt("return",_this12.getPropertyValueByPath(_this12.selectedRows,valueExpression,key,sourceType,eventConfig));case 51:return _context27.abrupt("return",_this12.getPropertyValueByPath(_this12.clickedCurrentTarget,valueExpression,key,sourceType,eventConfig));case 52:return _context27.next=54,_this12.replaceAsync(valueExpression,/{{.+?}}/gi,(function(e){return processExpression(e.replace(/{{|}}/gi,""),key)}));case 54:return _context27.abrupt("return",_context27.sent);case 55:return _context27.abrupt("return",deferredMappings[valueExpression]);case 56:return _context27.abrupt("return",_this12.getPropertyValueByPath(_this12.event,valueExpression,key,sourceType,eventConfig));case 57:return document.querySelector(valueExpression)?(_urlObj2=new URL(window.location.origin+document.querySelector(valueExpression).getAttribute("href")),_urlParams2=_urlObj2.searchParams,_url=_urlParams2.get("RootFolder")):(_urlObj3=new URL(window.location.origin+document.querySelector('iframe[id^="FilterIframe"]').getAttribute("filterlink")),_urlParams3=_urlObj3.searchParams,_url=_urlParams3.get("RootFolder"),null===_url&&(_url=_this12.context.listUrl)),_context27.abrupt("return",_url);case 59:case"end":return _context27.stop()}}),_callee26,null,[[22,,29,32],[42,46]])})));return function(e,t){return _ref17.apply(this,arguments)}}(),isMappingIgnored=function(e){return!_this12.trackerSettings.SendUserName&&-1!==["userDisplayName","authorDisplayName"].indexOf(e)||(!_this12.trackerSettings.SendOffice&&-1!==["office","userOffice","authorOffice","pageAuthorOffice"].indexOf(e)||(!_this12.trackerSettings.SendJobTitle&&-1!==["jobTitle","userJobTitle","authorJobTitle","pageAuthorJobTitle"].indexOf(e)||!_this12.trackerSettings.SendDepartment&&-1!==["department","userDepartment","authorDepartment","pageAuthorDepartment"].indexOf(e)))},processMappings=function(){var e=Object(C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_4__.a)(C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.mark((function e(t){var r,n,a,_,o,i;return C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r={},n=Object.keys(t),a=0,_=n;case 3:if(!(a<_.length)){e.next=14;break}if(o=_[a],!isMappingIgnored(o)){e.next=7;break}return e.abrupt("continue",11);case 7:return i=t[o],e.next=10,processExpression(i,o);case 10:r[o]=e.sent;case 11:a++,e.next=3;break;case 14:return e.abrupt("return",r);case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),_context29.next=10,processMappings(mappings);case 10:return _context29.abrupt("return",_context29.sent);case 11:case"end":return _context29.stop()}}),_callee28)})));function processMappingsInternal(e,t,r,n,a){return _processMappingsInternal.apply(this,arguments)}return processMappingsInternal}()},{key:"getPropertyValueByPath",value:function(e,t,r,n,a){function _(e){try{return decodeURI(e)}catch(t){return e}}var o,i=t.split("."),s=e,c=Object(C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createForOfIteratorHelper__WEBPACK_IMPORTED_MODULE_5__.a)(i);try{for(c.s();!(o=c.n()).done;){var l=o.value;try{if("parseJson()"===l)s=JSON.parse(s);else if("getContentTypeFromSchemaXml()"===l){var p=s.substring(s.indexOf("ID=")+4,s.indexOf("Name=")-2),u=!1;p.startsWith("0x010108")&&(s="Wiki Page",u=!0),p.startsWith("0x010109")&&(s="Web Part Page",u=!0),p.startsWith("0x0101009")&&(s="Site Page",u=!0),p.startsWith("0x010100C568DB52D9D0A14D9B2FDCC96666E9F2007948130EC3DB064584E219954237AF390064DEA0F")&&(s="Welcome Page",u=!0),p.startsWith("0x010100C568DB52D9D0A14D9B2FDCC96666E9F2007948130EC3DB064584E219954237AF390097EAECA")&&(s="Page",u=!0),p.startsWith("0x010100C568DB52D9D0A14D9B2FDCC96666E9F2007948130EC3DB064584E219954237AF3900242457E")&&(s="Article Page",u=!0),p.startsWith("0x011000EC145E9F882C448EAAF71817CF337AB9006E4214AC2CA3074E802309A5A3BCABC2")&&(s="News Page",u=!0),!1===u&&(s="Other")}else if("getContentTypeFromId()"===l){var d=s,f=!1;d.startsWith("0x010108")&&(s="Wiki Page",f=!0),d.startsWith("0x010109")&&(s="Web Part Page",f=!0),d.startsWith("0x0101009")&&(s="Site Page",f=!0),d.startsWith("0x010100C568DB52D9D0A14D9B2FDCC96666E9F2007948130EC3DB064584E219954237AF390064DEA0F")&&(s="Welcome Page",f=!0),d.startsWith("0x010100C568DB52D9D0A14D9B2FDCC96666E9F2007948130EC3DB064584E219954237AF390097EAECA")&&(s="Page",f=!0),d.startsWith("0x010100C568DB52D9D0A14D9B2FDCC96666E9F2007948130EC3DB064584E219954237AF3900242457E")&&(s="Article Page",f=!0),d.startsWith("0x011000EC145E9F882C448EAAF71817CF337AB9006E4214AC2CA3074E802309A5A3BCABC2")&&(s="News Page",f=!0),!1===f&&(s="Other")}else if("toJson()"===l)s=JSON.stringify(s);else if("toLowerCase()"===l)s=s.toLowerCase();else if("anonymize()"===l)s=this.trackerSettings.SendUserIdEncoded?(this.trackerSettings.UseSha3?crypto_js_sha3__WEBPACK_IMPORTED_MODULE_10___default.a:crypto_js_sha1__WEBPACK_IMPORTED_MODULE_9___default.a)(s).toString():s;else if("hash()"===l)s=(this.trackerSettings.UseSha3?crypto_js_sha3__WEBPACK_IMPORTED_MODULE_10___default.a:crypto_js_sha1__WEBPACK_IMPORTED_MODULE_9___default.a)(s).toString();else if("getFileLeafRefByTagName()"==l){var m=(new DOMParser).parseFromString(s,"application/xml");m.querySelector("parsererror")&&console.log("error while parsing"),s=m.getElementsByTagName("d:FileLeafRef")[0].innerHTML}else if("getIdByTagName()"==l){var b=(new DOMParser).parseFromString(s,"application/xml");b.querySelector("parsererror")&&console.log("error while parsing"),s=b.getElementsByTagName("d:Id")[0].innerHTML}else if("getFileRefByTagName()"==l){var h=(new DOMParser).parseFromString(s,"application/xml");h.querySelector("parsererror")&&console.log("error while parsing"),s=h.getElementsByTagName("d:FileRef")[0].innerHTML}else if("getTitleByTagName()"==l){var g=(new DOMParser).parseFromString(s,"application/xml");g.querySelector("parsererror")&&console.log("error while parsing"),s=g.getElementsByTagName("d:Title")[0].innerHTML}else if("decodeClaims()"===l){var P=s.split("|");s=P[P.length-1]}else if("getLastSegment()"===l){var k=s.split("/");s=""===k?k[k.length-2]:k[k.length-1]}else if("substractExt()"===l){var E=s.split(".");s=s!==E[E.length-1]?E[E.length-1]:""}else if("getId()"===l){var S=s.parentElement.getAttribute("id");s=S}else if("getTitle()"===l){var w=s.parentElement.parentElement.parentElement.querySelector("td > img").getAttribute("title");s=w}else if("getTitleOfListItem()"===l){var C=void 0,O=document.querySelectorAll('div[aria-selected="true"]');C=1===O.length?O[0].querySelector("button[data-automationid='FieldRenderer-name']").innerHTML:s.closest(".ms-DetailsRow-fields").querySelector("button[data-automationid='FieldRenderer-name']").innerText,s=C}else if("getParent()"===l){var v=s.split("/");v.pop(),s=v.join("/")}else if("decodeUrl()"===l){s=_(s)}else if("parseInt()"===l){s=parseInt(s)}else if("getSearchQueryText()"===l)if(s.indexOf("QueryText=")>-1){var x=s.substring(s.indexOf("QueryText="));s=x.substring(x.indexOf("QueryTemplate=")-3,x.indexOf("QueryText=")+12)}else s=void 0;else if("getSearchQueryCount()"===l)if(s.indexOf("TotalRows")>-1)try{x=s.substring(s.indexOf("TotalRows"));s=x.substring(x.indexOf("TotalRowsIncludingDuplicates")-2,x.indexOf("TotalRows")+11)}catch(y){s="0"}else s="0";else"removeAspxExtension()"===l?s.indexOf(".aspx")>-1&&(s=s.replace(".aspx","")):"parseKeyValueArray()"===l?s=Object.assign.apply(Object,[{}].concat(Object(C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_1__.a)(s.map((function(e){return Object(C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__.a)({},e.Key,e.Value)}))))):""!==l&&s&&(s=s[l]);a.name.indexOf("search")>-1&&l.indexOf("Total")>-1&&!s&&(s="0")}catch(M){"dev"===this.config.mode&&console.log("[TRACKER] ".concat(M," | Property: '").concat(r,"', path: '").concat(n,":").concat(t,"' in '").concat(a.name,"' event."))}}}catch(U){c.e(U)}finally{c.f()}return s}},{key:"replaceAsync",value:function(){var e=Object(C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_4__.a)(C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.mark((function e(t,r,n){var a,_,o;return C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.match(r),_=[],a.forEach((function(e){var t=n(e);_.push(t)})),e.next=5,Promise.all(_);case 5:return o=e.sent,e.abrupt("return",t.replace(r,(function(){return o.shift()})));case 7:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"isStartPage",value:function(e){return/\/start\.aspx$/.test(e)}},{key:"checkElementType",value:function(){var e=Object(C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_4__.a)(C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.mark((function e(){var t,r;return C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(window.top.document.querySelector("[class$='itm-selected']")){e.next=4;break}return e.abrupt("return",null);case 4:if(e.prev=4,!window.top.document.querySelector("[class$='itm-selected'] [isecb='TRUE'] div a").getAttribute("href").indexOf("listform.aspx")){e.next=9;break}return e.abrupt("return","item");case 9:if(!(t=window.top.document.querySelector("[class$='itm-selected'] [isecb='TRUE'] div a").getAttribute("href").split("/").pop())){e.next=21;break}if("aspx"!==(r=t.split(".").pop())){e.next=16;break}return e.abrupt("return","page");case 16:if(!/aspx\?/.test(r)){e.next=20;break}return e.abrupt("return","folder");case 20:return e.abrupt("return","file");case 21:e.next=26;break;case 23:return e.prev=23,e.t0=e.catch(4),e.abrupt("return",null);case 26:case"end":return e.stop()}}),e,null,[[4,23]])})));return function(){return e.apply(this,arguments)}}()},{key:"loadTagManager",value:function(){var e=Object(C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_4__.a)(C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.mark((function e(){return C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.trackerSettings.SiteId&&this.trackerSettings.ContainersUrl){e.next=2;break}return e.abrupt("return");case 2:try{!function(e,t,r,n,a){e.dataLayer=e.dataLayer||[],e.dataLayer.push=Array.prototype.push,e.dataLayer.push({start:(new Date).getTime(),event:"stg.start"});var _=t.getElementsByTagName("script")[0],o=t.createElement("script");var i=(e.location.href.match("stg_debug")||t.cookie.match("stg_debug"))&&!e.location.href.match("stg_disable_debug");!function(e,r,n){var a="";if(n){var _=new Date;_.setTime(_.getTime()+24*n*60*60*1e3),a="; expires="+_.toUTCString()}t.cookie=e+"="+r+a+"; path=/"}("stg_debug",i?1:"",i?14:-1);var s=[];i&&s.push("stg_debug");var c=s.length>0?"?"+s.join("&"):"";o.async=!0,o.src=a+"/"+n+".js"+c,_.parentNode.insertBefore(o,_),function(t,r,n){t[r]=t[r]||{};for(var a=0;a<n.length;a++)!function(n){t[r][n]=t[r][n]||{},t[r][n].api=t[r][n].api||function(){var t=[].slice.call(arguments,0);"string"==typeof t[0]&&e.dataLayer.push({event:r+"."+n+":"+t[0],parameters:[].slice.call(arguments,1)})}}(n[a])}(e,"ppms",["tm","cm"])}(window,document,0,this.trackerSettings.SiteId,this.trackerSettings.ContainersUrl)}catch(t){}case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"urlTracker",value:function(){var e=Object(C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_4__.a)(C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.mark((function e(){var t=this;return C_Users_Lukasz_source_repos_PPMS_Sharepoint_integration_WSP_piwik_pro_sharepoint_365_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this._nav={origin:window.location.origin,pathname:window.location.pathname,type:_IUrlTrackerProps__WEBPACK_IMPORTED_MODULE_15__.a.INIT,search:new URLSearchParams(window.location.search),search_decoded:[]},this.getSearchDecoded(),e.prev=2,function(e){var r=e.pushState;e.pushState=function(n,a,_){r.apply(e,[n,a,_]),t.updateCurrentPath(_IUrlTrackerProps__WEBPACK_IMPORTED_MODULE_15__.a.CLICK,_)}}(window.history),window.addEventListener("popstate",(function(e){t.updateCurrentPath(_IUrlTrackerProps__WEBPACK_IMPORTED_MODULE_15__.a.HISTORY)})),e.next=10;break;case 7:return e.prev=7,e.t0=e.catch(2),e.abrupt("return",Promise.reject(e.t0));case 10:return e.abrupt("return",Promise.resolve());case 11:case"end":return e.stop()}}),e,this,[[2,7]])})));return function(){return e.apply(this,arguments)}}()},{key:"updateCurrentPath",value:function(e){arguments.length>1&&void 0!==arguments[1]||window.location.href;this._nav={origin:window.location.origin,pathname:window.location.pathname,type:e,search:new URLSearchParams(window.location.search)},this.getSearchDecoded(),this.trackPageView()}}]),Tracking}()},311:function(e,t,r){"use strict";var n=r(27),a=r(39),_=r(3),o=r.n(_),i=r(20),s=r(8),c=function(){function e(t){Object(n.a)(this,e),this.traceLog=void 0,window[t]=window[t]||[],this.traceLog=window[t]}return Object(a.a)(e,[{key:"trackPageView",value:function(){var e=Object(s.a)(o.a.mark((function e(t,r,n){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.fixArrayPush(),this.traceLog.push(Object(i.a)({event:t,url:r},n));case 2:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"trackEvent",value:function(){var e=Object(s.a)(o.a.mark((function e(t,r,n){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.fixArrayPush(),this.traceLog.push(Object(i.a)({event:t,duration:n},r));case 2:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"fixArrayPush",value:function(){window.sevenTag||(this.traceLog.push=window.Array.prototype.push)}}]),e}(),l=function(){function e(){Object(n.a)(this,e)}return Object(a.a)(e,[{key:"trackPageView",value:function(){var e=Object(s.a)(o.a.mark((function e(t,r,n){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("[TRACKER] ".concat(t," - URL: ").concat(r,", Data: "),n);case 1:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"trackEvent",value:function(){var e=Object(s.a)(o.a.mark((function e(t,r,n){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("[TRACKER] Event - Name: ".concat(t,", Duration: ").concat(n,", Data: "),r);case 1:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}()}]),e}(),p=r(53),u=function(){function e(t){Object(n.a)(this,e),this.trackers=void 0,this.trackers=t}return Object(a.a)(e,[{key:"trackPageView",value:function(){var e=Object(s.a)(o.a.mark((function e(t,r,n){var a,_,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=Object(p.a)(this.trackers),e.prev=1,a.s();case 3:if((_=a.n()).done){e.next=9;break}return i=_.value,e.next=7,i.trackPageView(t,r,n);case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),a.e(e.t0);case 14:return e.prev=14,a.f(),e.finish(14);case 17:case"end":return e.stop()}}),e,this,[[1,11,14,17]])})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"trackEvent",value:function(){var e=Object(s.a)(o.a.mark((function e(t,r,n){var a,_,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=Object(p.a)(this.trackers),e.prev=1,a.s();case 3:if((_=a.n()).done){e.next=9;break}return i=_.value,e.next=7,i.trackEvent(t,r,n);case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),a.e(e.t0);case 14:return e.prev=14,a.f(),e.finish(14);case 17:case"end":return e.stop()}}),e,this,[[1,11,14,17]])})));return function(t,r,n){return e.apply(this,arguments)}}()}]),e}();r.d(t,"a",(function(){return d}));var d=function(){function e(t,r){Object(n.a)(this,e),this.config=t,this.context=r}return Object(a.a)(e,[{key:"getTracker",value:function(){var e=[],t=this.config.trackers.find((function(e){return"string"!==typeof e&&"GlobalArrayTracker"===e.name}));return t&&"string"!==typeof t&&e.push(new c(t.params.variableName)),this.config.trackers.some((function(e){return"ConsoleTracker"===e||"string"!==typeof e&&"ConsoleTracker"===e.name}))&&e.push(new l),new u(e)}}]),e}()},330:function(e,t,r){e.exports=r(557)},450:function(e,t,r){},457:function(e,t){},459:function(e,t){},469:function(e,t){},471:function(e,t){},498:function(e,t){},500:function(e,t){},501:function(e,t){},506:function(e,t){},508:function(e,t){},515:function(e,t){},517:function(e,t){},535:function(e,t){},537:function(e,t){},549:function(e,t){},552:function(e,t){},557:function(e,t,r){"use strict";r.r(t);var n=r(20),a=r(3),_=r.n(a),o=r(8);r(332),r(338),r(339),r(340),r(341),r(342),r(343),r(344),r(345),r(346),r(347),r(348),r(349),r(350),r(351),r(353),r(355),r(214),r(358),r(359),r(220),r(361),r(362),r(364),r(365),r(366),r(367),r(368),r(369),r(370),r(371),r(372),r(374),r(375),r(221),r(377),r(433);window.Promise||r(434);var i=r(0),s=r.n(i),c=r(90),l=r.n(c),p=r(138),u=r(46),d=(r(450),r(54)),f=r(605),m=r(608),b=r(24),h=r(594),g=r(618),P=r(48),k=r(612),E=r(306),S=r(614),w=r(619),C=r(622),O=r(621),v=r(615),x=r(617),y=r(610),M=r(307),U=r(616),T=r(12),D=r(107),I=function(e){var t=Object(i.useState)({}),r=Object(d.a)(t,2),a=r[0],s=r[1],c=Object(i.useState)(!0),l=Object(d.a)(c,2),p=l[0],u=l[1],f=Object(i.useState)(!1),m=Object(d.a)(f,2),b=m[0],h=m[1],g=Object(i.useState)(null),P=Object(d.a)(g,2),k=P[0],E=P[1],S=function(){var e=Object(o.a)(_.a.mark((function e(){var t;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,E(null),u(!0),e.next=5,D.a.getSettings();case 5:t=e.sent,s(t),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),E(e.t0.toString());case 12:return e.prev=12,u(!1),e.finish(12);case 15:case"end":return e.stop()}}),e,null,[[0,9,12,15]])})));return function(){return e.apply(this,arguments)}}(),w=function(){var t=Object(o.a)(_.a.mark((function t(r){return _.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,E(null),h(!0),t.next=5,D.a.setSettings(r);case 5:e(),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),E(t.t0.toString());case 11:return t.prev=11,h(!1),t.finish(11);case 14:case"end":return t.stop()}}),t,null,[[0,8,11,14]])})));return function(e){return t.apply(this,arguments)}}();Object(i.useEffect)((function(){S()}),[]);return{inputs:a,isLoading:p,isSaving:b,error:k,handleSubmit:function(e){e&&e.preventDefault(),w(a)},handleInputChange:function(e){e.persist(),s((function(t){return Object(n.a)(Object(n.a)({},t),{},Object(T.a)({},e.target.name,e.target.value))}))},handleCheckboxChange:function(e,t){e.persist(),s((function(r){return Object(n.a)(Object(n.a)({},r),{},Object(T.a)({},e.target.name,t))}))},handleChoiceGroupChangeBoolean:function(e,t){e.persist(),s((function(r){return Object(n.a)(Object(n.a)({},r),{},Object(T.a)({},e.target.name,"true"===(null===t||void 0===t?void 0:t.key)))}))},setValue:function(e,t){s((function(r){return Object(n.a)(Object(n.a)({},r),{},Object(T.a)({},e,t))}))}}},L=r(7),A=r(25);var W=function(e){var t,r=I(e.dismiss),n=r.inputs,a=r.isLoading,_=r.isSaving,o=r.error,c=r.handleSubmit,l=r.handleInputChange,p=r.handleCheckboxChange,u=r.handleChoiceGroupChangeBoolean,f=r.setValue,m=Object(i.useState)(!1),b=Object(d.a)(m,2),T=b[0],D=b[1];Object(i.useEffect)((function(){if(!a&&!o){var e="Adding"===n.PiwikStatus||"New"===n.PiwikStatus||(!n.PiwikStatus||"Deleting"!==n.PiwikStatus&&"Deactivating"!==n.PiwikStatus)&&n.IsTrackingActive;D(e)}}),[n,o,a]);var W=Object(h.a)((function(e,t){e.persist(),f(L.a.PiwikStatus,t?"Adding":"Deleting")}));return s.a.createElement(s.a.Fragment,null,a&&s.a.createElement(g.a,{size:P.a.large,styles:{root:{textAlign:"center",marginTop:40}}}),!a&&s.a.createElement("form",{onSubmit:c},s.a.createElement(k.a,{"aria-label":"Piwik PRO"},s.a.createElement(E.a,{headerText:"Site Collection Settings"},s.a.createElement(S.a,{tokens:{childrenGap:10}},s.a.createElement(w.a,{style:{fontWeight:"bold",fontSize:18}},"General"),s.a.createElement(C.a,{styles:{root:{marginTop:"0 !important"}}},"It may take up to one hour for the changes on this tab to apply for all users."),s.a.createElement(O.a,{label:"Enable tracking",name:"EnableTracking",onChange:W,checked:T}),T&&!n.IsTrackingActive&&s.a.createElement(C.a,{style:{color:"#FFB900"}},"The following settings will be available after activation."),s.a.createElement(v.a,{label:"Piwik PRO Site ID",disabled:!0,name:"SiteId",value:n.SiteId}),n.Url&&n.SiteId&&s.a.createElement(x.a,{href:"".concat(n.Url,"/analytics/#/").concat(n.SiteId,"/dashboards"),target:"_blank","data-interception":"off"},"Piwik PRO Analytics"),s.a.createElement(w.a,{style:{fontWeight:"bold",fontSize:18}},"User Information"),s.a.createElement(y.a,{name:"UseSiteCollectionSettings",onChange:u,selectedKey:null===(t=n.UseSiteCollectionSettings)||void 0===t?void 0:t.toString(),options:[{key:"false",text:"Use global settings",styles:{root:{display:"inline-block",marginBottom:5}}},{key:"true",text:"Overwrite global settings",styles:{root:{display:"inline-block",marginLeft:30,marginBottom:5}}}],styles:{applicationRole:{marginTop:0}},disabled:!T||!n.IsTrackingActive}),s.a.createElement(O.a,{label:"Send User ID anonymized",name:"SendUserIdEncoded",onChange:p,checked:n.SendUserIdEncoded,disabled:!T||!n.IsTrackingActive||!n.UseSiteCollectionSettings}),s.a.createElement(O.a,{label:"Send extended user information:",name:"SendExtendedUserinfo",onChange:p,checked:n.SendExtendedUserinfo,disabled:!T||!n.IsTrackingActive||!n.UseSiteCollectionSettings}),s.a.createElement(S.a,{tokens:{childrenGap:10},style:{marginLeft:20}},s.a.createElement(O.a,{label:"Username (display name)",name:"SendUserName",onChange:p,checked:n.SendUserName,disabled:!T||!n.IsTrackingActive||!n.UseSiteCollectionSettings||!n.SendExtendedUserinfo}),s.a.createElement(O.a,{label:"Office",name:"SendOffice",onChange:p,checked:n.SendOffice,disabled:!T||!n.IsTrackingActive||!n.UseSiteCollectionSettings||!n.SendExtendedUserinfo}),s.a.createElement(O.a,{label:"JobTitle",name:"SendJobTitle",onChange:p,checked:n.SendJobTitle,disabled:!T||!n.IsTrackingActive||!n.UseSiteCollectionSettings||!n.SendExtendedUserinfo}),s.a.createElement(O.a,{label:"Department",name:"SendDepartment",onChange:p,checked:n.SendDepartment,disabled:!T||!n.IsTrackingActive||!n.UseSiteCollectionSettings||!n.SendExtendedUserinfo})))),n.IsCurrentUserPiwikAdmin&&s.a.createElement(E.a,{headerText:"Global Settings"},s.a.createElement(S.a,{tokens:{childrenGap:10}},s.a.createElement(w.a,{style:{fontWeight:"bold",fontSize:18}},"Default site collection settings"),s.a.createElement(O.a,{label:"Send User ID anonymized",name:"TemplateSendUserIdEncoded",onChange:p,checked:n.TemplateSendUserIdEncoded}),s.a.createElement(O.a,{label:"Send extended user information:",name:"TemplateSendExtendedUserinfo",onChange:p,checked:n.TemplateSendExtendedUserinfo}),s.a.createElement(S.a,{tokens:{childrenGap:10},style:{marginLeft:20}},s.a.createElement(O.a,{label:"Username (display name)",name:"TemplateSendUserName",onChange:p,checked:n.TemplateSendUserName,disabled:!n.TemplateSendExtendedUserinfo}),s.a.createElement(O.a,{label:"Office",name:"TemplateSendOffice",onChange:p,checked:n.TemplateSendOffice,disabled:!n.TemplateSendExtendedUserinfo}),s.a.createElement(O.a,{label:"JobTitle",name:"TemplateSendJobTitle",onChange:p,checked:n.TemplateSendJobTitle,disabled:!n.TemplateSendExtendedUserinfo}),s.a.createElement(O.a,{label:"Department",name:"TemplateSendDepartment",onChange:p,checked:n.TemplateSendDepartment,disabled:!n.TemplateSendExtendedUserinfo})))),n.IsCurrentUserPiwikAdmin&&s.a.createElement(E.a,{headerText:"Connection Settings"},s.a.createElement(S.a,{tokens:{childrenGap:10}},s.a.createElement(w.a,{style:{fontWeight:"bold",fontSize:18}},"Piwik PRO Analytics Suite instance connection settings"),s.a.createElement(O.a,{label:"Enforce SSL communication",name:"EnforceSslComunication",onChange:p,checked:n.EnforceSslComunication}),s.a.createElement(v.a,{label:"Piwik PRO Instance URL",name:"Url",onChange:l,value:n.Url}),s.a.createElement(v.a,{label:"Piwik PRO Custom Containers URL",name:"ContainersUrl",onChange:l,value:n.ContainersUrl}),s.a.createElement(O.a,{label:"Use SHA3 to anonymize UserID (default SHA1)",name:"UseSha3",onChange:p,checked:n.UseSha3}),s.a.createElement(v.a,{label:"Piwik PRO Client ID",name:"ClientID",onChange:l,value:n.ClientID}),s.a.createElement(v.a,{label:"Piwik PRO Client Secret",name:"ClientSecret",onChange:l,value:n.ClientSecret}))),n.IsCurrentUserPiwikAdmin&&s.a.createElement(E.a,{headerText:"About"},s.a.createElement(S.a,{tokens:{childrenGap:10}},s.a.createElement(w.a,{style:{fontWeight:"bold",fontSize:18}},"Versions"),s.a.createElement(C.a,null,"Tracker: ",A.a.version),s.a.createElement(C.a,null,"Job: ",n.JobVersion)))),s.a.createElement("div",{style:{marginTop:10}},s.a.createElement(M.a,{type:"submit",text:"Submit",disabled:_}),s.a.createElement(U.a,{text:"Cancel",onClick:function(){return e.dismiss()},disabled:_}))))},R=r(308),B=r.n(R);Object(f.a)(void 0,{disableWarnings:!0});var j=function(){var e=s.a.useState(!1),t=Object(d.a)(e,2),r=t[0],n=t[1],a=Object(h.a)((function(){return n(!0)})),_=Object(h.a)((function(){return n(!1)}));return window.GeneratePiwikProSettings=function(){return a()},s.a.createElement(s.a.Fragment,null,s.a.createElement("a",{onClick:a,className:"o365sx-neutral-accent-link piwik-pro-settings-link ".concat(B.a.piwikProLink)},"Piwik PRO"),s.a.createElement(m.a,{headerText:"Piwik PRO",isOpen:r,type:b.a.medium,onDismiss:_,closeButtonAriaLabel:"Close"},s.a.createElement(W,{dismiss:_})))},K=r(309),F=r(27),z=r(39),N=function(){function e(){Object(F.a)(this,e)}return Object(z.a)(e,[{key:"siteId",get:function(){return _spPageContextInfo.siteId}},{key:"siteIdWithoutBrackets",get:function(){return _spPageContextInfo.siteId.replace("{","").replace("}","")}},{key:"webId",get:function(){return _spPageContextInfo.webId}},{key:"webIdWithoutBrackets",get:function(){return _spPageContextInfo.webId.replace("{","").replace("}","")}},{key:"webTitle",get:function(){return _spPageContextInfo.webTitle}},{key:"siteTitle",get:function(){return _spPageContextInfo.siteServerRelativeUrl.split("/").lastItem}},{key:"userLoginName",get:function(){return _spPageContextInfo.userLoginName}},{key:"userDisplayName",get:function(){return _spPageContextInfo.userDisplayName}},{key:"webAbsoluteUrl",get:function(){return _spPageContextInfo.webAbsoluteUrl}},{key:"webServerRelativeUrl",get:function(){return _spPageContextInfo.webServerRelativeUrl}},{key:"listUrl",get:function(){return _spPageContextInfo.listUrl}},{key:"siteAbsoluteUrl",get:function(){return _spPageContextInfo.siteAbsoluteUrl}},{key:"serverRequestPath",get:function(){return _spPageContextInfo.serverRequestPath}},{key:"listTitle",get:function(){return _spPageContextInfo.listTitle}},{key:"listId",get:function(){return _spPageContextInfo.listId.replace("{","").replace("}","")}},{key:"pageListId",get:function(){return _spPageContextInfo.pageListId?_spPageContextInfo.pageListId.replace("{","").replace("}",""):null}},{key:"webTemplateConfiguration",get:function(){return _spPageContextInfo.webTemplateConfiguration}},{key:"pageItemId",get:function(){return _spPageContextInfo.pageItemId?_spPageContextInfo.pageItemId.toString():null}},{key:"siteServerRelativeUrl",get:function(){return _spPageContextInfo.siteServerRelativeUrl}},{key:"serverUrl",get:function(){return window.location.origin+_spPageContextInfo.serverRequestPath}}]),e}();Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var q=r(49),V=function(){var e=Object(o.a)(_.a.mark((function e(){var t;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new K.a(new N),e.next=3,t.init();case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();q.d.setup({sp:{baseUrl:_spPageContextInfo.webAbsoluteUrl},ie11:!0}),V();var G,J,H,$,X,Q,Y=null===p.a||void 0===p.a?void 0:p.a.getValue("customizations"),Z=Object(u.a)();Y&&Z&&((null===(G=Y.settings)||void 0===G||null===(J=G.theme)||void 0===J?void 0:J.effects)||(Y.settings.theme.effects=Object(n.a)({},Z.effects)),(null===(H=Y.settings)||void 0===H||null===($=H.theme)||void 0===$?void 0:$.spacing)||(Y.settings.theme.spacing=Object(n.a)({},Z.spacing)),(null===(X=Y.settings)||void 0===X||null===(Q=X.theme)||void 0===Q?void 0:Q.fonts)||(Y.settings.theme.fonts=Object(n.a)({},Z.fonts)));var ee=function(){if(!1!==_spPageContextInfo.isSiteAdmin){var e=function(){var e=document.querySelector("#O365_Settings_navbardatalinks ul");if(e&&!e.querySelector(".piwikProLink")){var t=document.createElement("li");t.className="piwikProLink",e.append(t),l.a.render(s.a.createElement(j,null),t)}var r=document.querySelector("#O365_MainLink_Settings.o365cs-spo-topbarMenuOpen");if(r){var n=r.parentElement.querySelector(".contextMenuPopup");if(n&&!n.querySelector(".piwikProLinkContextMenu")){var a=document.createElement("span");a.className="piwikProLinkContextMenu o365button o365cs-contextMenuItem ms-fcl-b ms-fcl-b-h ms-fcl-b-f",n.querySelector("[aria-label='Piwik PRO']")&&(a.className+=" hiddenPiwikLink"),n.append(a),l.a.render(s.a.createElement(j,null),a)}}if(document.querySelector("#suiteBarButtons .ms-siteactions-root")&&!document.querySelector(".piwikProLink")){var _=document.createElement("div");_.className="piwikProLink piwikProLinkSiteActions",document.body.append(_),l.a.render(s.a.createElement(j,null),_)}},t=document.querySelector("#O365_NavHeader, #suiteBarButtons .ms-siteactions-root");null===t||void 0===t||t.addEventListener("click",(function(){var t=setInterval(e,100);setTimeout((function(){return clearInterval(t)}),1e3)}),!0)}};ee(),window.asyncDeltaManager&&window.asyncDeltaManager.add_pageLoaded((function(){ee()})),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},7:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(27),a=function e(){Object(n.a)(this,e)};a.ClientID="piwik_clientid",a.ClientSecret="piwik_clientsecret",a.ContainersUrl="piwik_containersurl",a.EnforceSslComunication="piwik_enforcessl",a.IsConnectedToMetaSite="isconnectedtometasite",a.IsTrackingActive="piwik_istrackingactive",a.MetaSiteId="piwik_metasitename",a.PiwikStatus="PiwikStatus",a.JobVersion="piwik_jobversion",a.SendDepartment="piwik_senddepartment",a.SendExtendedUserinfo="piwik_senduserextendedinfo",a.SendJobTitle="piwik_sendjobtitle",a.SendOffice="piwik_sendoffice",a.SendUserIdEncoded="piwik_senduserencoded",a.SendUserName="piwik_sendusername",a.SiteId="piwik_metasitenamestored",a.TemplateSendDepartment="piwik_templatesenddepartment",a.TemplateSendExtendedUserinfo="piwik_templatesenduserextendedinfo",a.TemplateSendJobTitle="piwik_templatesendjobtitle",a.TemplateSendOffice="piwik_templatesendoffice",a.TemplateSendUserIdEncoded="piwik_templatesenduserencoded",a.TemplateSendUserName="piwik_templatesendusername",a.Url="piwik_serviceurl",a.UseSha3="piwik_sha3",a.UseSiteCollectionSettings="piwik_usesitecollectionsettings"}},[[330,1,2]]]);
//# sourceMappingURL=main.3d09fae0.chunk.js.map